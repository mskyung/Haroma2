<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Haroma Keyboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
</head>
<body>
<!--<h3 id="app-title">Haroma (Har<font color="gray">mony</font> Ha<font color="gray">ngul </font>Aroma)</h3>-->
<div id="display-container">
	<label for="display" style="display:block;margin:6px 0;font-size:14px;">원문</label>
	<textarea id="display" placeholder="여기에 원문을 직접 입력하세요"readonly></textarea>
	<!--<textarea id="haromaInput"></textarea>-->
</div>
<div id="keyboard-container">
    <div class="layer active" data-layer="KR">
        <svg class="keyboard" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
		<polygon class="octagon-big1" data-click="ㄱ" data-dblclick="ㄲ" data-drag="ㅋ" points="71,41 59,29 70,2 98,30"></polygon>
		<text x="75" y="30" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄱ</text>
		<text x="75" y="33" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㄲ</text>
		<text x="75" y="22" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅋ</text>
		<polygon class="octagon-big2" data-click="ㄴ" data-dblclick="ㄹ" data-drag="ㄹ" points="29,59 41,71 30,98 2,70"></polygon>
		<text x="26" y="79" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄴ</text>
		<text x="26" y="71" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㄹ</text>
		<polygon class="octagon-big3" data-click="ㄷ" data-dblclick="ㄸ" data-drag="ㅌ" points="29,41 29,59 2,70 2,30"></polygon>
		<text x="16" y="55" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄷ</text>
		<text x="16" y="58" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㄸ</text>
		<text x="16" y="47" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅌ</text>
		<polygon class="octagon-big4" data-click="ㅁ" data-dblclick="ㅍ" data-drag="ㅍ" points="59,71 71,59 98,70 70,98"></polygon>
		<text x="75" y="80" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅁ</text>
		<text x="75" y="72" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅍ</text>
		<polygon class="octagon-big5" data-click="ㅂ" data-dblclick="ㅃ" data-drag="ㅃ" points="41,71 59,71 70,98 30,98"></polygon>
		<text x="50" y="89" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅂ</text>
		<text x="50" y="92" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅃ</text>
		<polygon class="octagon-big6" data-click="ㅅ" data-dblclick="ㅆ" data-drag="ㅆ" points="30,2 70,2 59,29 41,29"></polygon>
		<text x="50" y="20" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅅ</text>
		<text x="50" y="23" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅆ</text>
		<polygon class="octagon-big7" data-click="ㅇ" data-dblclick="ㅎ" data-drag="ㅎ" points="71,59 71,41 98,30 98,70"></polygon>
		<text x="85" y="55" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅇ</text>
		<text x="85" y="47" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅎ</text>
		<polygon class="octagon-big8" data-click="ㅈ" data-dblclick="ㅉ" data-drag="ㅊ" points="41,29 29,41 2,30 30,2"></polygon>
		<text x="26" y="30" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅈ</text>
		<text x="26" y="33" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅉ</text>
		<text x="26" y="22" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅊ</text>

		<polygon class="octagon-center" data-click="" data-dblclick="" data-drag="" points="41,29 59,29 71,41 71,59 59,71 41,71 29,59 29,41"></polygon>
		<text x="50" y="39" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅗ</text>
		<text x="50" y="68" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅜ</text>
		<text x="35" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅓ</text>
		<text x="65" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅏ</text>
		<text x="44" y="52" font-size="8" text-anchor="middle" fill="#dbdbd7" pointer-events="none">␣</text>
		<text x="50" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">.</text>
		<text x="54" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">,</text>
		<text x="58" y="53" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">↵</text>
		</svg>
    </div>
	
    <div class="layer" data-layer="EN">
		<svg class="keyboard" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
		<polygon class="octagon-big1" data-click="g" data-dblclick="k" data-drag="q" points="71,41 59,29 70,2 98,30"></polygon>
		<text x="68.5" y="22" font-size="9" text-anchor="middle" fill="black" pointer-events="none">g</text>
		<text x="74.5" y="28" font-size="9" text-anchor="middle" fill="black" pointer-events="none">k</text>
		<text x="80" y="34" font-size="9" text-anchor="middle" fill="black" pointer-events="none">q</text>
		<polygon class="octagon-big2" data-click="n" data-dblclick="l" data-drag="r" points="29,59 41,71 30,98 2,70"></polygon>
		<text x="20" y="72" font-size="9" text-anchor="middle" fill="black" pointer-events="none">n</text>
		<text x="26" y="79" font-size="9" text-anchor="middle" fill="black" pointer-events="none">l</text>
		<text x="32" y="84" font-size="9" text-anchor="middle" fill="black" pointer-events="none">r</text>
		<polygon class="octagon-big3" data-click="d" data-dblclick="t" data-drag="t" points="29,41 29,59 2,70 2,30"></polygon>
		<text x="16" y="48" font-size="9" text-anchor="middle" fill="black" pointer-events="none">d</text>
		<text x="16" y="59" font-size="9" text-anchor="middle" fill="black" pointer-events="none">t</text>
		<polygon class="octagon-big4" data-click="m" data-dblclick="p" data-drag="f" points="59,71 71,59 98,70 70,98"></polygon>
		<text x="81" y="72" font-size="9" text-anchor="middle" fill="black" pointer-events="none">m</text>
		<text x="75" y="79" font-size="9" text-anchor="middle" fill="black" pointer-events="none">p</text>
		<text x="69" y="85" font-size="9" text-anchor="middle" fill="black" pointer-events="none">f</text>
		<polygon class="octagon-big5" data-click="b" data-dblclick="v" data-drag="v" points="41,71 59,71 70,98 30,98"></polygon>
		<text x="46" y="89" font-size="9" text-anchor="middle" fill="black" pointer-events="none">b</text>
		<text x="54" y="89" font-size="9" text-anchor="middle" fill="black" pointer-events="none">v</text>
		<polygon class="octagon-big6" data-click="s" data-dblclick="c" data-drag="x" points="30,2 70,2 59,29 41,29"></polygon>
		<text x="42" y="19" font-size="9" text-anchor="middle" fill="black" pointer-events="none">s</text>
		<text x="49" y="19" font-size="9" text-anchor="middle" fill="black" pointer-events="none">c</text>
		<text x="57" y="19" font-size="9" text-anchor="middle" fill="black" pointer-events="none">x</text>
		<polygon class="octagon-big7" data-click="h" data-dblclick="w" data-drag="w" points="71,59 71,41 98,30 98,70"></polygon>
		<text x="86" y="48" font-size="9" text-anchor="middle" fill="black" pointer-events="none">h</text>
		<text x="86" y="59" font-size="9" text-anchor="middle" fill="black" pointer-events="none">w</text>
		<polygon class="octagon-big8" data-click="j" data-dblclick="z" data-drag="z" points="41,29 29,41 2,30 30,2"></polygon>
		<text x="29" y="26" font-size="9" text-anchor="middle" fill="black" pointer-events="none">j</text>
		<text x="22" y="33" font-size="9" text-anchor="middle" fill="black" pointer-events="none">z</text>

		<polygon class="octagon-center" data-click="" data-dblclick="" data-drag="" points="41,29 59,29 71,41 71,59 59,71 41,71 29,59 29,41"></polygon>
		<text x="61" y="43" font-size="8" text-anchor="middle" fill="black" pointer-events="none">i</text>
		<text x="50" y="38" font-size="8" text-anchor="middle" fill="black" pointer-events="none">o</text>		
		<text x="50" y="68" font-size="8" text-anchor="middle" fill="black" pointer-events="none">u</text>
		<text x="35" y="54" font-size="8" text-anchor="middle" fill="black" pointer-events="none">e</text>
		<text x="40" y="65" font-size="8" text-anchor="middle" fill="black" pointer-events="none">y</text>
		<text x="65" y="54" font-size="8" text-anchor="middle" fill="black" pointer-events="none">a</text>
		<text x="44" y="52" font-size="8" text-anchor="middle" fill="#dbdbd7" pointer-events="none">␣</text>
		<text x="50" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">.</text>
		<text x="54" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">,</text>
		<text x="58" y="53" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">↵</text>
		</svg>
    </div>
	  
    <div class="layer" data-layer="SYM">
        <svg class="keyboard" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
		<polygon class="octagon-big1" data-click="&#94;" data-dblclick="&#36;" data-drag="&quot;" points="71,41 59,29 70,2 98,30"></polygon>
		<text x="68.5" y="22" font-size="9" text-anchor="middle" fill="black" pointer-events="none">^</text>
		<text x="74.5" y="28" font-size="9" text-anchor="middle" fill="black" pointer-events="none">$</text>
		<text x="81" y="37" font-size="9" text-anchor="middle" fill="black" pointer-events="none">"</text>
		<polygon class="octagon-big2" data-click="&#91;" data-dblclick=":" data-drag="_" points="29,59 41,71 30,98 2,70"></polygon>
		<text x="20" y="72" font-size="9" text-anchor="middle" fill="black" pointer-events="none">[</text>
		<text x="26" y="79" font-size="9" text-anchor="middle" fill="black" pointer-events="none">:</text>
		<text x="31" y="82" font-size="9" text-anchor="middle" fill="black" pointer-events="none">_</text>
		<polygon class="octagon-big3" data-click="&#40;" data-dblclick="&lt;" data-drag="&#123;" points="29,41 29,59 2,70 2,30"></polygon>
		<text x="16" y="45" font-size="9" text-anchor="middle" fill="black" pointer-events="none">(</text>
		<text x="15" y="54" font-size="9" text-anchor="middle" fill="black" pointer-events="none"><</text>
		<text x="16" y="61" font-size="9" text-anchor="middle" fill="black" pointer-events="none">{</text>
		<polygon class="octagon-big4" data-click="&#93;" data-dblclick=";" data-drag="&#45;" points="59,71 71,59 98,70 70,98"></polygon>
		<text x="81" y="72" font-size="9" text-anchor="middle" fill="black" pointer-events="none">]</text>
		<text x="75" y="79" font-size="9" text-anchor="middle" fill="black" pointer-events="none">;</text>
		<text x="69" y="85" font-size="9" text-anchor="middle" fill="black" pointer-events="none">-</text>
		<polygon class="octagon-big5" data-click="&#47;" data-dblclick="!" data-drag="&#92;" points="41,71 59,71 70,98 30,98"></polygon>
		<text x="43" y="89" font-size="9" text-anchor="middle" fill="black" pointer-events="none">/</text>
		<text x="50" y="89" font-size="9" text-anchor="middle" fill="black" pointer-events="none">!</text>
		<text x="57" y="89" font-size="9" text-anchor="middle" fill="black" pointer-events="none">\</text>
		<polygon class="octagon-big6" data-click="@" data-dblclick="&amp;" data-drag="#" points="30,2 70,2 59,29 41,29"></polygon>
		<text x="42" y="18" font-size="9" text-anchor="middle" fill="black" pointer-events="none">@</text>
		<text x="51" y="19" font-size="9" text-anchor="middle" fill="black" pointer-events="none">&</text>
		<text x="58" y="19" font-size="9" text-anchor="middle" fill="black" pointer-events="none">#</text>
		<polygon class="octagon-big7" data-click="&#41;" data-dblclick="&gt;" data-drag="&#125;" points="71,59 71,41 98,30 98,70"></polygon>
		<text x="86" y="45" font-size="9" text-anchor="middle" fill="black" pointer-events="none">)</text>
		<text x="87" y="54" font-size="9" text-anchor="middle" fill="black" pointer-events="none">></text>
		<text x="86" y="61" font-size="9" text-anchor="middle" fill="black" pointer-events="none">}</text>
		<polygon class="octagon-big8" data-click="~" data-dblclick="%" data-drag="&#39;" points="41,29 29,41 2,30 30,2"></polygon>
		<text x="30" y="23" font-size="9" text-anchor="middle" fill="black" pointer-events="none">~</text>
		<text x="25" y="29" font-size="9" text-anchor="middle" fill="black" pointer-events="none">%</text>
		<text x="20" y="37" font-size="9" text-anchor="middle" fill="black" pointer-events="none">'</text>

		<polygon class="octagon-center" data-click="." data-dblclick="?" data-drag="," points="41,29 59,29 71,41 71,59 59,71 41,71 29,59 29,41"></polygon>
		<text x="40" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">.</text>
		<text x="50" y="54" font-size="9" text-anchor="middle" fill="black" pointer-events="none">?</text>
		<text x="60" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">,</text>
		</svg>
    </div>
	  
    <div class="layer" data-layer="NUM">
        <svg class="keyboard" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
		<polygon class="octagon-big1" data-click="3" data-dblclick="&#46;" data-drag="&#46;" points="71,41 59,29 70,2 98,30"></polygon>
		<text x="75" y="30" font-size="11" text-anchor="middle" fill="black" pointer-events="none">3</text>
		<text x="69" y="34" font-size="10" text-anchor="middle" fill="blue" pointer-events="none">.</text>
		<polygon class="octagon-big2" data-click="7" data-dblclick="±" data-drag="±" points="29,59 41,71 30,98 2,70"></polygon>
		<text x="25" y="79" font-size="11" text-anchor="middle" fill="black" pointer-events="none">7</text>
		<text x="32" y="70" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">±</text>
		<polygon class="octagon-big3" data-click="4" data-dblclick="&#247;" data-drag="&#247;" points="29,41 29,59 2,70 2,30"></polygon>
		<text x="15" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">4</text>
		<text x="24" y="52" font-size="7" text-anchor="middle" fill="blue" pointer-events="none">÷</text>
		<polygon class="octagon-big4" data-click="9" data-dblclick="=" data-drag="=" points="59,71 71,59 98,70 70,98"></polygon>
		<text x="75" y="80" font-size="11" text-anchor="middle" fill="black" pointer-events="none">9</text>
		<text x="68" y="72" font-size="7" text-anchor="middle" fill="blue" pointer-events="none">=</text>
		<polygon class="octagon-big5" data-click="8" data-dblclick="-" data-drag="-" points="41,71 59,71 70,98 30,98"></polygon>
		<text x="50" y="89" font-size="11" text-anchor="middle" fill="black" pointer-events="none">8</text>
		<text x="50" y="78" font-size="7" text-anchor="middle" fill="blue" pointer-events="none">-</text>
		<polygon class="octagon-big6" data-click="2" data-dblclick="+" data-drag="+" points="30,2 70,2 59,29 41,29"></polygon>
		<text x="50" y="20" font-size="11" text-anchor="middle" fill="black" pointer-events="none">2</text>
		<text x="50" y="27" font-size="7" text-anchor="middle" fill="blue" pointer-events="none">+</text>
		<polygon class="octagon-big7" data-click="6" data-dblclick="&times;" data-drag="&times;" points="71,59 71,41 98,30 98,70"></polygon>
		<text x="85" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">6</text>
		<text x="76" y="52" font-size="7" text-anchor="middle" fill="blue" pointer-events="none">*</text>
		<polygon class="octagon-big8" data-click="1" data-dblclick="&#44;" data-drag="&#44;" points="41,29 29,41 2,30 30,2"></polygon>
		<text x="25" y="29" font-size="11" text-anchor="middle" fill="black" pointer-events="none">1</text>
		<text x="31" y="34" font-size="9" text-anchor="middle" fill="blue" pointer-events="none">,</text>

		<polygon class="octagon-center" data-click="5" data-dblclick="0" data-drag="0" points="41,29 59,29 71,41 71,59 59,71 41,71 29,59 29,41"></polygon>
		<text x="50" y="48" font-size="11" text-anchor="middle" fill="black" pointer-events="none">5</text>
		<text x="50" y="62" font-size="11" text-anchor="middle" fill="black" pointer-events="none">0</text>
		</svg>
    </div>
	  
	<div class="layer" data-layer="K-E">
        <svg class="keyboard" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
		<polygon class="octagon-big1" data-click="r" data-dblclick="R" data-drag="z" points="71,41 59,29 70,2 98,30"></polygon>
		<text x="75" y="30" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄱ</text>
		<text x="75" y="33" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㄲ</text>
		<text x="75" y="22" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅋ</text>
		<polygon class="octagon-big2" data-click="s" data-dblclick="f" data-drag="f" points="29,59 41,71 30,98 2,70"></polygon>
		<text x="26" y="79" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄴ</text>
		<text x="26" y="71" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㄹ</text>
		<polygon class="octagon-big3" data-click="e" data-dblclick="E" data-drag="x" points="29,41 29,59 2,70 2,30"></polygon>
		<text x="16" y="55" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㄷ</text>
		<text x="16" y="58" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㄸ</text>
		<text x="16" y="47" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅌ</text>
		<polygon class="octagon-big4" data-click="a" data-dblclick="v" data-drag="v" points="59,71 71,59 98,70 70,98"></polygon>
		<text x="75" y="80" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅁ</text>
		<text x="75" y="72" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅍ</text>
		<polygon class="octagon-big5" data-click="q" data-dblclick="Q" data-drag="Q" points="41,71 59,71 70,98 30,98"></polygon>
		<text x="50" y="89" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅂ</text>
		<text x="50" y="92" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅃ</text>
		<polygon class="octagon-big6" data-click="t" data-dblclick="T" data-drag="T" points="30,2 70,2 59,29 41,29"></polygon>
		<text x="50" y="20" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅅ</text>
		<text x="50" y="23" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅆ</text>
		<polygon class="octagon-big7" data-click="d" data-dblclick="g" data-drag="g" points="71,59 71,41 98,30 98,70"></polygon>
		<text x="85" y="55" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅇ</text>
		<text x="85" y="47" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅎ</text>
		<polygon class="octagon-big8" data-click="w" data-dblclick="W" data-drag="c" points="41,29 29,41 2,30 30,2"></polygon>
		<text x="26" y="30" font-size="12" text-anchor="middle" fill="black" pointer-events="none">ㅈ</text>
		<text x="26" y="33" font-size="6" text-anchor="middle" fill="gray" pointer-events="none">ㅉ</text>
		<text x="26" y="22" font-size="6" text-anchor="middle" fill="blue" pointer-events="none">ㅊ</text>

		<polygon class="octagon-center" data-click="l" data-dblclick="ㅢ" data-drag="m" points="41,29 59,29 71,41 71,59 59,71 41,71 29,59 29,41"></polygon>
		<text x="50" y="39" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅗ</text>
		<text x="50" y="68" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅜ</text>
		<text x="35" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅓ</text>
		<text x="65" y="54" font-size="11" text-anchor="middle" fill="black" pointer-events="none">ㅏ</text>
		<text x="44" y="52" font-size="8" text-anchor="middle" fill="#dbdbd7" pointer-events="none">␣</text>
		<text x="50" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">.</text>
		<text x="54" y="52" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">,</text>
		<text x="58" y="53" font-size="7" text-anchor="middle" fill="#dbdbd7" pointer-events="none">↵</text>
		</svg>
    </div>
	  
</div>
<div id="settings-modal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h3>Keyboard Setting</h3>
        <div class="settings-controls">
            <div class="control-group">
                <label>Size</label>
                <button id="scale-down">-</button>
                <button id="scale-up">+</button>
            </div>
            <div class="control-group">
                <label>Left-Right</label>
                <button id="hand-left">L</button>
                <button id="hand-right">R</button>
            </div>
            <div class="control-group">
                <label>Up-Down</label>
				<button id="position-down">↓</button>
                <button id="position-up">↑</button>
            </div>
        </div>
    </div>
</div>
<div id="layer-switcher">
    <div class="button-row">
        <button id="refresh-btn">Clear</button>        
        <button id="copy-btn">Copy</button>
		<button id="cursor-left">|←</button>		
		<button id="cursor-right">→|</button>		
		<button id="backspace">⌫</button>
		<button id="delete-btn">⌦</button>	
    </div>
    <div class="button-row">
		<button id="settings-btn">☼</button>
		<button data-layer="K-E">KE</button>
		<button data-layer="NUM">N</button>
		<button data-layer="SYM">S</button>
		<button data-layer="EN">E</button>
        <button data-layer="KR" class="active">K</button> 
    </div>
</div>
<script src="script.js"></script>
<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('sw.js')
        .then(registration => {
          console.log('Service Worker registered: ', registration);
        })
        .catch(registrationError => {
          console.log('Service Worker registration failed: ', registrationError);
        });
    });
  }



<!-- === Haroma: 무암호(HAROMA0) 간편 모드 + 기본 키보드 차단 패치 === -->
<!-- 1) 기본 키보드 차단: display textarea를 readonly + inputmode=none -->
<script>
  // 실행 시점에 display 입력창을 readonly로 전환(모바일 기본 키보드 차단)
  (function () {
    const ta = document.getElementById('display');
    if (!ta) return;
    ta.setAttribute('readonly', 'true');   // 키보드 안 뜨게
    ta.setAttribute('inputmode', 'none');  // 지원 브라우저에서 추가 차단
    // 포커스되면 우리 Haroma 키보드만 보여주기
    ta.addEventListener('focus', () => {
      const kb = document.getElementById('keyboard-container');
      if (kb) kb.style.display = 'block';
    });
  })();
</script>

<!-- 2) 무암호 토큰(HAROMA0) 인/디코더 + 자동 판별 디코더 -->
<script>
  // UTF-8 Base64 유틸 (브라우저 안전)
  const _enc = new TextEncoder();
  const _dec = new TextDecoder();
  function _strToB64(s) {
    const bytes = _enc.encode(s);
    let bin = '';
    for (let i = 0; i < bytes.length; i++) bin += String.fromCharCode(bytes[i]);
    return btoa(bin);
  }
  function _b64ToStr(b64) {
    const bin = atob(b64);
    const bytes = new Uint8Array(bin.length);
    for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
    return _dec.decode(bytes);
  }

  // 무암호 포맷: HAROMA0..<base64(plaintext)>
  const HEADER_NONE = 'HAROMA0';
  const HEADER_SEC  = 'HAROMA1'; // 과거/기존 암호문이 들어올 수도 있으니 식별만 해 둠

  // 무암호 인코더
  function haromaEncodeNoKey(plain) {
    return `${HEADER_NONE}..${_strToB64(plain)}`;
  }

  // 자동 디코더: HAROMA0이면 키 없이, HAROMA1이면 안내, 그 외엔 평문으로 처리
  function haromaDecodeAuto(token) {
    if (typeof token !== 'string') return '';
    if (token.startsWith(HEADER_NONE + '.')) {
      const parts = token.split('.');
      const b64 = parts[2] || '';
      return _b64ToStr(b64);
    }
    if (token.startsWith(HEADER_SEC + '.')) {
      // 기존 script.js의 SecretChat(AES-GCM+PBKDF2) 로직이 존재하지만,
      // 오빠야 요구대로 "비밀번호는 넣지 않는" 모드이므로 여기서는 안내만 하고 통과.
      alert('이 메시지는 보안(HAROMA1) 형식입니다. 지금은 무암호 모드라 복호화하지 않습니다.');
      return token;
    }
    // 헤더 없으면 평문
    return token;
  }

  // 버튼 없이도 쓰기 좋게: window에 helper 바인딩
  window.HaromaSimple = {
    encode: () => {
      const ta = document.getElementById('display');
      if (!ta) return;
      ta.value = haromaEncodeNoKey(ta.value);
      ta.focus();
    },
    decode: () => {
      const ta = document.getElementById('display');
      if (!ta) return;
      ta.value = haromaDecodeAuto(ta.value.trim());
      ta.focus();
    }
  };
</script>

<!-- 3) 간단 버튼(선택사항): 필요하면 표시, 필요없으면 이 블록은 생략 가능 -->
<div style="margin:45px 0; display:flex; gap:10px; justify-content:center;">
  <button type="wide-btn" onclick="HaromaSimple.encode()">암</button>
  <button type="wide-btn" onclick="HaromaSimple.decode()">복</button>
</div>
<!-- === /Haroma patch === -->

</script>
</body>
</html>